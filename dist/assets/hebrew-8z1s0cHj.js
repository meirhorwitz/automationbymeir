import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as v}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";const f={apiKey:"AIzaSyBDv0d_OVQsHzD_biFpkMvFrXaZguCYG58",authDomain:"automationbymeir.firebaseapp.com",projectId:"automationbymeir",storageBucket:"automationbymeir.firebasestorage.app",messagingSenderId:"216703427811",appId:"1:216703427811:web:a2c848833870a1415c91d6",measurementId:"G-D8GQDGVR08"};v(f);const y="https://script.google.com/macros/s/AKfycbzYDJcrt8eT52qSQJf6sQ842LyUNjZQm-DGLaM_g757DDdC0viqZSgAyUilmOmxgJ_Cyw/exec",p=document.getElementById("step1"),u=document.getElementById("step2"),h=document.getElementById("toStep2"),L=document.getElementById("toStep1"),l=document.getElementById("projectForm"),r=document.getElementById("submitBtn"),g=document.getElementById("slotsLoader"),i=document.getElementById("timeSlots"),o=document.getElementById("form-message");let d=null;h.addEventListener("click",()=>{l.checkValidity()?(p.classList.remove("active"),u.classList.add("active"),b()):l.reportValidity()});L.addEventListener("click",()=>{u.classList.remove("active"),p.classList.add("active")});async function b(){g.style.display="block",i.innerHTML="";try{const t=await(await fetch(y)).json();if(t.success)E(t.slots);else throw new Error(t.error||"Failed to load slots.")}catch(e){console.error("Error fetching slots:",e),i.innerHTML='<p style="color: var(--danger);">Could not load available times. Please try again later.</p>'}finally{g.style.display="none"}}function E(e){if(e.length===0){i.innerHTML='<p style="color: var(--light);">No available slots in the next 7 days. Please check back later.</p>';return}const t=e.reduce((s,n)=>{const c=new Date(n).toLocaleDateString("he-IL",{weekday:"long",month:"long",day:"numeric"});return s[c]||(s[c]=[]),s[c].push(n),s},{});let a="";for(const s in t)a+=`<div style="grid-column: 1 / -1;"><h4 style="color: var(--accent); margin-top: 1rem;">${s}</h4></div>`,t[s].forEach(n=>{const m=new Date(n).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit",hour12:!1});a+=`<div class="time-slot" data-value="${n}">${m}</div>`});i.innerHTML=a}i.addEventListener("click",e=>{e.target.classList.contains("time-slot")&&(document.querySelectorAll(".time-slot").forEach(t=>t.classList.remove("selected")),e.target.classList.add("selected"),d=e.target.dataset.value)});l.addEventListener("submit",async e=>{if(e.preventDefault(),!d){alert("נא לבחור שעה.");return}r.disabled=!0,r.textContent="קובע פגישה...";const t=new FormData(l),a={name:t.get("name"),email:t.get("email"),details:t.get("details"),dateTime:d,lang:"he"};try{await fetch(y,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),l.style.display="none",o.style.display="block",o.className="success",o.innerHTML="<h3>תודה!</h3><p>פגישתך נקבעה. אימייל אישור נשלח אליך.</p>"}catch(s){console.error("Error submitting form:",s),o.style.display="block",o.className="error",o.innerHTML="<h3>שגיאה</h3><p>משהו השתבש. אנא נסה שוב או צור איתי קשר ישירות.</p>",r.disabled=!1,r.textContent="שליחה וקביעת פגישה"}});const S=document.getElementById("navToggle"),I=document.querySelector(".nav-links");S.addEventListener("click",()=>{I.classList.toggle("show")});window.addEventListener("scroll",()=>{const e=document.getElementById("navbar");window.scrollY>50?e.classList.add("scrolled"):e.classList.remove("scrolled")});
