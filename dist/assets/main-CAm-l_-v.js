import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as f}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";const h={apiKey:"AIzaSyBDv0d_OVQsHzD_biFpkMvFrXaZguCYG58",authDomain:"automationbymeir.firebaseapp.com",projectId:"automationbymeir",storageBucket:"automationbymeir.firebasestorage.app",messagingSenderId:"216703427811",appId:"1:216703427811:web:a2c848833870a1415c91d6",measurementId:"G-D8GQDGVR08"};f(h);const u="https://script.google.com/macros/s/AKfycbzYDJcrt8eT52qSQJf6sQ842LyUNjZQm-DGLaM_g757DDdC0viqZSgAyUilmOmxgJ_Cyw/exec",g=document.getElementById("step1"),p=document.getElementById("step2"),v=document.getElementById("toStep2"),b=document.getElementById("toStep1"),i=document.getElementById("projectForm"),l=document.getElementById("submitBtn"),y=document.getElementById("slotsLoader"),r=document.getElementById("timeSlots"),a=document.getElementById("form-message");let d=null;v.addEventListener("click",()=>{i.checkValidity()?(g.classList.remove("active"),p.classList.add("active"),L()):i.reportValidity()});b.addEventListener("click",()=>{p.classList.remove("active"),g.classList.add("active")});async function L(){y.style.display="block",r.innerHTML="";try{const e=await(await fetch(u)).json();if(e.success)S(e.slots);else throw new Error(e.error||"Failed to load slots.")}catch(t){console.error("Error fetching slots:",t),r.innerHTML='<p style="color: var(--danger);">Could not load available times. Please try again later.</p>'}finally{y.style.display="none"}}function S(t){if(t.length===0){r.innerHTML='<p style="color: var(--light);">No available slots in the next 7 days. Please check back later.</p>';return}const e=t.reduce((o,n)=>{const c=new Date(n).toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"});return o[c]||(o[c]=[]),o[c].push(n),o},{});let s="";for(const o in e)s+=`<div style="grid-column: 1 / -1;"><h4 style="color: var(--accent); margin-top: 1rem;">${o}</h4></div>`,e[o].forEach(n=>{const m=new Date(n).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",hour12:!1});s+=`<div class="time-slot" data-value="${n}">${m}</div>`});r.innerHTML=s}r.addEventListener("click",t=>{t.target.classList.contains("time-slot")&&(document.querySelectorAll(".time-slot").forEach(e=>e.classList.remove("selected")),t.target.classList.add("selected"),d=t.target.dataset.value)});i.addEventListener("submit",async t=>{if(t.preventDefault(),!d){alert("Please select a time slot.");return}l.disabled=!0,l.textContent="Scheduling...";const e=new FormData(i),s={name:e.get("name"),email:e.get("email"),details:e.get("details"),dateTime:d,lang:"en"};try{await fetch(u,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),i.style.display="none",a.style.display="block",a.className="success",a.innerHTML="<h3>Thank You!</h3><p>Your meeting is scheduled. A confirmation email has been sent to you.</p>"}catch(o){console.error("Error submitting form:",o),a.style.display="block",a.className="error",a.innerHTML="<h3>Error</h3><p>Something went wrong. Please try again or contact me directly.</p>",l.disabled=!1,l.textContent="Submit & Schedule"}});
