import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as f}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";const h={apiKey:"AIzaSyBDv0d_OVQsHzD_biFpkMvFrXaZguCYG58",authDomain:"automationbymeir.firebaseapp.com",projectId:"automationbymeir",storageBucket:"automationbymeir.firebasestorage.app",messagingSenderId:"216703427811",appId:"1:216703427811:web:a2c848833870a1415c91d6",measurementId:"G-D8GQDGVR08"};f(h);const p="https://script.google.com/macros/s/AKfycbzYDJcrt8eT52qSQJf6sQ842LyUNjZQm-DGLaM_g757DDdC0viqZSgAyUilmOmxgJ_Cyw/exec",g=document.getElementById("step1"),u=document.getElementById("step2"),v=document.getElementById("toStep2"),L=document.getElementById("toStep1"),i=document.getElementById("projectForm"),l=document.getElementById("submitBtn"),y=document.getElementById("slotsLoader"),r=document.getElementById("timeSlots"),a=document.getElementById("form-message");let d=null;v.addEventListener("click",()=>{i.checkValidity()?(g.classList.remove("active"),u.classList.add("active"),b()):i.reportValidity()});L.addEventListener("click",()=>{u.classList.remove("active"),g.classList.add("active")});async function b(){y.style.display="block",r.innerHTML="";try{const e=await(await fetch(p)).json();if(e.success)S(e.slots);else throw new Error(e.error||"Failed to load slots.")}catch(t){console.error("Error fetching slots:",t),r.innerHTML='<p style="color: var(--danger);">Could not load available times. Please try again later.</p>'}finally{y.style.display="none"}}function S(t){if(t.length===0){r.innerHTML='<p style="color: var(--light);">No available slots in the next 7 days. Please check back later.</p>';return}const e=t.reduce((s,n)=>{const c=new Date(n).toLocaleDateString("he-IL",{weekday:"long",month:"long",day:"numeric"});return s[c]||(s[c]=[]),s[c].push(n),s},{});let o="";for(const s in e)o+=`<div style="grid-column: 1 / -1;"><h4 style="color: var(--accent); margin-top: 1rem;">${s}</h4></div>`,e[s].forEach(n=>{const m=new Date(n).toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit",hour12:!1});o+=`<div class="time-slot" data-value="${n}">${m}</div>`});r.innerHTML=o}r.addEventListener("click",t=>{t.target.classList.contains("time-slot")&&(document.querySelectorAll(".time-slot").forEach(e=>e.classList.remove("selected")),t.target.classList.add("selected"),d=t.target.dataset.value)});i.addEventListener("submit",async t=>{if(t.preventDefault(),!d){alert("נא לבחור שעה.");return}l.disabled=!0,l.textContent="קובע פגישה...";const e=new FormData(i),o={name:e.get("name"),email:e.get("email"),details:e.get("details"),dateTime:d,lang:"he"};try{await fetch(p,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),i.style.display="none",a.style.display="block",a.className="success",a.innerHTML="<h3>תודה!</h3><p>פגישתך נקבעה. אימייל אישור נשלח אליך.</p>"}catch(s){console.error("Error submitting form:",s),a.style.display="block",a.className="error",a.innerHTML="<h3>שגיאה</h3><p>משהו השתבש. אנא נסה שוב או צור איתי קשר ישירות.</p>",l.disabled=!1,l.textContent="שליחה וקביעת פגישה"}});
